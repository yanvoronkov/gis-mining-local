<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____410295421']= array(base64_decode('aXNfc3'.'RyaW5n'),base64_decode('c3R'.'yd'.'G9'.'sb3'.'dl'.'cg=='),base64_decode('aXN'.'fYXJ'.'y'.'YX'.'k'.'='),base64_decode('a'.'XNfc'.'3RyaW5n'),base64_decode('Z3pkZWNvZGU='),base64_decode('Ym'.'FzZTY0X2RlY29k'.'Z'.'Q='.'='),base64_decode('dXJs'.'ZGVj'.'b2Rl'),base64_decode('YXJy'.'YXlfcmV2ZXJzZQ=='),base64_decode('Z3plbmN'.'vZGU='),base64_decode('Ym'.'FzZT'.'Y0X'.'2VuY29kZ'.'Q='.'='),base64_decode('dXJsZW'.'5jb2Rl'),base64_decode(''.'YmluMmhleA=='),base64_decode('aXN'.'fYXJyYXk='),base64_decode(''.'c3RydG9sb3dl'.'c'.'g=='),base64_decode('aXNfYXJy'.'YXk'.'='),base64_decode('am9p'.'bg'.'=='),base64_decode('Zm5'.'t'.'Y'.'XR'.'j'.'aA=='),base64_decode('cm'.'F3dXJsZGVjb2Rl'),base64_decode(''.'c'.'3Vic'.'3R'.'y'),base64_decode('c3Vic3R'.'y'),base64_decode('c3RyX3Jl'.'cGxhY2'.'U='),base64_decode('cHJlZ19'.'xdW90Z'.'Q=='),base64_decode('cHJl'.'Z'.'19tYXR'.'jaA=='));if(!function_exists(__NAMESPACE__.'\\___429487222')){function ___429487222($_1079186035){static $_704251272= false; if($_704251272 == false) $_704251272=array('YWN0aW9u','aW'.'50d'.'mF'.'s','cGF'.'0'.'aA==','Y29u'.'d'.'GV4dA==',''.'a2V5cw==','c'.'H'.'JvY2V'.'z'.'cw'.'==','ZW5jb2'.'Rpbm'.'c=','c'.'HJlZ'.'19yZXBsYWNl','cG'.'F'.'0'.'aA==','Y'.'2'.'9udG'.'V'.'4dA==','a2V5'.'cw==','cHJ'.'vY2Vzcw==','ZW5jb2'.'R'.'pbmc=','c'.'G'.'F0'.'d'.'G'.'V'.'ybg==','cHJlZ19tYXRj'.'aA='.'=','cGF0aA==',''.'Y'.'29udGV4'.'dA==','a2V5cw==','cH'.'JvY'.'2'.'Vzcw==','Z'.'W5jb2Rpbmc'.'=','cGF0'.'dGVy'.'bg==','cG9zdF9hY3R'.'pb24=','Y2hlY2tfY3NyZg='.'=',''.'cG'.'F'.'0aA='.'=','Y'.'29ud'.'G'.'V4'.'dA==',''.'a2V5cw==',''.'cH'.'JvY2Vz'.'cw==',''.'ZW'.'5'.'jb'.'2Rpbmc=','c'.'GF0dGVyb'.'g==',''.'Y'.'WN0aW9'.'u','YW'.'N0aW9u','Y'.'WN0aW9'.'u','Y'.'WN0aW9u','Y'.'WN0aW9u','YWN0'.'aW'.'9u','cG9zdF'.'9hY3Rpb'.'24=','ZW'.'5j'.'b2R'.'pbmc'.'=','ZW5jb'.'2Rpbmc=',''.'ZW5'.'jb2Rpbmc'.'=','Z'.'W'.'5jb2Rpbmc=','ZW5jb'.'2'.'Rp'.'bmc=',''.'Z'.'W5'.'jb2'.'Rpbmc=',''.'Z3o=','YmFzZT'.'Y0','dXJ'.'s',''.'aGV4','Lg='.'=','L'.'w==',''.'aW5'.'kZXgucG'.'hw','L2lu'.'Z'.'G'.'V4LnBoc'.'A'.'==','U0NS'.'SVB'.'UX'.'05BT'.'UU=',''.'L2luZGV4LnB'.'ocA='.'=',''.'U0NSS'.'VBU'.'X05B'.'TUU=',''.'U'.'0NS'.'S'.'VBUX'.'05BTUU=','U0NSS'.'VB'.'UX05BTUU=','fg==','fl4=','fg'.'==','XH4'.'=','JH4=');return base64_decode($_704251272[$_1079186035]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_1980153526; protected $_556428926; protected $_462717839; protected $_1318344032; protected $_1716802413; public static function make(array $_1390441746):?static{ $_1390441746= static::prepareRuleParameters($_1390441746); return match($_1390441746[___429487222(0)]){ ___429487222(1) => new IntvalRule( $_1390441746[___429487222(2)], $_1390441746[___429487222(3)], $_1390441746[___429487222(4)], $_1390441746[___429487222(5)], $_1390441746[___429487222(6)]), ___429487222(7) => new PregReplaceRule( $_1390441746[___429487222(8)], $_1390441746[___429487222(9)], $_1390441746[___429487222(10)], $_1390441746[___429487222(11)], $_1390441746[___429487222(12)], $_1390441746[___429487222(13)]), ___429487222(14) => new PregMatchRule( $_1390441746[___429487222(15)], $_1390441746[___429487222(16)], $_1390441746[___429487222(17)], $_1390441746[___429487222(18)], $_1390441746[___429487222(19)], $_1390441746[___429487222(20)], $_1390441746[___429487222(21)]), ___429487222(22) => new CsrfRule( $_1390441746[___429487222(23)], $_1390441746[___429487222(24)], $_1390441746[___429487222(25)], $_1390441746[___429487222(26)], $_1390441746[___429487222(27)], $_1390441746[___429487222(28)],), default => null,};} protected static function prepareRuleParameters(array $_1741332594): array{ if($GLOBALS['____410295421'][0]($_1741332594[___429487222(29)])){ $_1741332594[___429487222(30)]= $GLOBALS['____410295421'][1]($_1741332594[___429487222(31)]);} elseif($GLOBALS['____410295421'][2]($_1741332594[___429487222(32)])){ $_2059487011= $_1741332594[___429487222(33)]; $_1741332594[___429487222(34)]= $_2059487011[(1288/2-644)]; $_1741332594[___429487222(35)]= $_2059487011[round(0+0.2+0.2+0.2+0.2+0.2)];} $_1741332594[___429487222(36)]=!empty($_1741332594[___429487222(37)])? $_1741332594[___429487222(38)]:[]; if($GLOBALS['____410295421'][3]($_1741332594[___429487222(39)])){ $_1741332594[___429487222(40)]=[$_1741332594[___429487222(41)]];} return $_1741332594;}  public function __construct($_1980153526, $_556428926, $_462717839, $_1318344032, $_1716802413){ $this->_1980153526= $_1980153526; $this->_556428926= $this->castContext($_556428926); $this->_462717839= $this->castKeys($_462717839); $this->_1318344032= $_1318344032; $this->_1716802413= $_1716802413;} public function evaluateValue($_1309735139){ if(!empty($this->_1716802413)){ foreach($this->_1716802413 as $_340988852){ $_1309735139= match($_340988852){ 'gz' => $GLOBALS['____410295421'][4]($_1309735139), 'base64' => $GLOBALS['____410295421'][5]($_1309735139), 'url' => $GLOBALS['____410295421'][6]($_1309735139), 'hex' => hex2bin($_1309735139)};}} $_1079365350= $this->evaluate($_1309735139); if(!empty($this->_1716802413) && $_1079365350 instanceof ModifyResult){ $_622531558= $_1079365350->getCleanValue(); foreach($GLOBALS['____410295421'][7]($this->_1716802413) as $_340988852){ $_622531558= match($_340988852){ ___429487222(42) => $GLOBALS['____410295421'][8]($_622531558), ___429487222(43) => $GLOBALS['____410295421'][9]($_622531558), ___429487222(44) => $GLOBALS['____410295421'][10]($_622531558), ___429487222(45) => $GLOBALS['____410295421'][11]($_622531558)};} $_1079365350= new ModifyResult($_622531558);} return $_1079365350;} abstract public function evaluate($_1309735139); protected function castContext($_556428926){ if(!$GLOBALS['____410295421'][12]($_556428926)){ $_556428926=[$_556428926];} foreach($_556428926 as $_660115411 => $_393995551){ $_556428926[$_660115411]= $GLOBALS['____410295421'][13]($_393995551);} return $_556428926;} protected function castKeys($_462717839){ if(!$GLOBALS['____410295421'][14]($_462717839)){ $_462717839=[$_462717839];} return $_462717839;} public function matchKey(array $_133177051): bool{ $_133177051= $GLOBALS['____410295421'][15](___429487222(46), $_133177051); foreach($this->_462717839 as $_1476183300){   if($GLOBALS['____410295421'][16]($_1476183300, $_133177051)){ return true;}} return false;}  public function matchPath($_215816759){ if($this->_1980153526 === '*'){ return true;}  $_189942996= new Uri($_215816759); $_706080235= $_189942996->getPath(); $_706080235= $GLOBALS['____410295421'][17]($_706080235);      if(str_ends_with($_706080235, ___429487222(47))){ $_706080235 .= ___429487222(48);} $_706080235= Path::normalize($_706080235);  $_143157222[]= $_706080235; if(str_ends_with($_706080235, ___429487222(49))){ $_143157222[]= $GLOBALS['____410295421'][18]($_706080235,(1192/2-596),-round(0+4.5+4.5));} elseif(str_ends_with($_SERVER[___429487222(50)], ___429487222(51))){ $_143157222[]= $GLOBALS['____410295421'][19]($_SERVER[___429487222(52)],(836-2*418),-round(0+1.8+1.8+1.8+1.8+1.8));} if($_706080235 !== $_SERVER[___429487222(53)]){ $_143157222[]= $_SERVER[___429487222(54)];}  if(str_starts_with($this->_1980153526, ___429487222(55))){ $_31818177= $this->_1980153526;} else{ $_31818177= ___429487222(56). $GLOBALS['____410295421'][20](___429487222(57), ___429487222(58), $GLOBALS['____410295421'][21]($this->_1980153526)). ___429487222(59);} foreach($_143157222 as $_1209111319){ if($this->_1980153526 === $_1209111319 || $GLOBALS['____410295421'][22]($_31818177, $_1209111319)){ return true;}} return false;}  public function getPath(){ return $this->_1980153526;}  public function getContext(){ return $this->_556428926;}  public function getKeys(){ return $this->_462717839;}  public function getProcess(){ return $this->_1318344032;}}?>